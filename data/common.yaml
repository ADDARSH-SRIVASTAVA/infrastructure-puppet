---
classes: 
  - asf999::create_user
  - base
  - customfact
  - ldapclient
  - pam
  - ssh # this pulls in both server and client by default
  - sudoers
  - snmp
  - base::snmp::createv3users
  - ntp



## MODULES
## ASF999
asf999::create_user::keycontent: |
  # pctony
  ## OSX SSH Key
  ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAgEAwPD3odJejHkT38r07Hwp8o/fPOV1lS6YfJcv7SjmJsL4fDiYJ4Uj+FM0fWhoc1Ud5ibowjWZ22f4rqcXGEGe61XD5CPs++xOhGD+4k3ZPuij0SAM6HqdrGT/vhIEcwxmT7xxSEPnenJ3N2dsRhP3YQUijgYBPEhEh9oa2bs5n9VbdUhguZGnuJB7+lxTyCdyMNX+4jv7MmvolksUfpc2bR4NpziPE6Ifrse/Jd2qi+9EES1xclNGROfyDYplYd0XAh2/I7L3rEzlCVpFoVAgaGmE7EKXwpTbHw4/wen89NDlkP4idvWz+mDRTYtCSgzJMKxb1AuVujNA/NB78boTcLs62n9C3VlDguNc1DL8PPS6xZXPr0EQxiKeS+1/p8Bmn41m8nqlHLm1LqaWY0grPNY9BkH8mBwQnmF1LaO8/kosleDbAhSgwU4Qvu3HN/4ql9BBkodX7xclO9dNfvUteMHZSc9FhtuddBhPewPV1/HiaH7he3ambpi4ox5vFKdtdC2bt5zH2cR+KoUl+Ra92XouO2KxLG14XBJ3sQQZuxAsNKr8gx2qzLwCKkEtBX7pt4cmKSwp88fzD6ZoyhsJeQhZrqyI+O4xySL1EMvGYTmGSyyigooCZM7CeuVX6NQr1uTMKt56GTzQ9W49TwFslEFw4rgwGCmhtaAaOO4lUSM= SSH Key generated 02/Jun/2010 (tony@pc-tony.com | pctony@apache.org)
  ## Old Key - to be deprecated
  ssh-dss AAAAB3NzaC1kc3MAAACBAOfdLbR3agsGLGQXodCqpmamVj08KLeHhVkPTHIzdtZgRNS6Xmx1MtMRugGDBovmxZ/i4uQY5c5BPvamV6SdyLJ1xUtM4eTUPw+xuP/W8hbhOjPceNMNqaIUMzfPF6gEhijXZNV+jQfPuvIIMxmBSvz3w07AgcXx+SmsyY0KIIAhAAAAFQDbEoLXzMDC7tKN5A8SrjQ1AQXMQQAAAIEAiIU1K56ciIlJ1YjtX7VyIzlXmzFeGigpvMtNA4S3/z5tkFhts+0tkFkD3L5ElFtVqPSfyTV86NSv/5iI+8LT9KNwliLKpyXrhVqnvfJKb4GA+fcKXZqG+p0y1UXSHkRDTxgS51/+CPbcifE++ZV1ePOsEhvdjhDPyjpm0VOp/vYAAACBAJ2/9fDn7DvFdOqXpDtG19oCPJLVazuXB4yFxvy7WA4XqAluifJhasGJlF5YLfQR26mllhd0gYvVE2TywSTK5A5j95mhL6D6yhu/uD9dmP3NK5lNRu6+rWpewm49sxhP+7P65CCWtQTApAwSd0J9S5XYKbEYndcvYIX00PJjSJ5C pctony@apache.org
  
  # humbedooh
  ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDKU0OarYDnMtEyneHtOAA/mpeJbXLCVA2yy8wl2fGQ/kzdRhBDCCjusV0D83cwKckJEGVInbYruLwq7Rk4e1k0hwHoVR28ps4B0IrsFlkQrfkS0plGq5VlbUU1lu9hdR+2o992NzK3BGJa6Bde493FaEnJf+s4dQM9kkb9keYXLdh9lC99xlxYg7P5gSlv+0tCAo3LisKM1vVfjLaXIv94KwRNjcrLH0rjrQt0UnkGTjoP+WonILz9CsFfJDncofFp4gyyioYDTqgyGbVauGAdfctrqc+c1x4sz+Hk2ocFjGZEGzHZ8E/ZRXpaa9QNeyc4vKAm9CSWyonLNr3+KyJfQP82w5IZIF8rMBjl3/m0zPUgXSitc6ebrLUFhrESyoFF0RfeqEYUzjf52uRVlPVSiSATmvccdHel/G6lUZrQScYUPOZT++C7TZNPzRNy/MzeLjF0jcrDYjCXEj1r9TkQtByoHKc0Cikokcmn15SPX9nBWScN0kQ9DCnQ1DRx0C2L/KJwiV8i/ziel8RFqg8n71v1H8Ve40F/m+03dZAUGzlE1wu+lXu/ZXjBgIu8vOmz3LK+k4UskiMiiktYq1N9RG+4l30JR/OlLIRhlKiernmWUFyGC4npbquaTKUsB6G6RKOC1WnLpuM5U1jIKVeOejoptJilaHvO0RiZxNP/ZQ== humbedooh-puppet-20130726
  
  # gmcdonald
  ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQC71HP9YspO1SDZ/5qNJNGE3MW27XiYc5gx2kaCJ2ZT3unZVRU60p3/fbMG5XwOzvmbN3Gzp2l2/8jKmngnQO0oHY9E2ZcVh14TblbgSErVPMM5zZBg40PvDRk61eECnGkXYfVKU5RzcDq5yYr4FFFFRh3pWjjBDBWtSczAXYavWPHOpNpQ1onudiCev/KHADXZS8J/HwhHmkVmxSWX+9upQlPlokXulZpMFqx6FPbBLk45Miq5xSYS3mN8dW3OupDHiKavKoLuzqom+7ndLhFUMX468htnhfUvTs9ajh7xBTfhziPJh+PkjeQLWNLdMQe0L8Ptd4IAxqSkegTCNit/LZbK/Jo6z7sBSdk2N+f8UIlK2do/9KlN30sFbVAK3nsIekxR+xQldEOMaCr83IM/b0G/mefxFrCdSm3z9SW84WKVt+DNADVKUMTm9ngOp2cjxPeXQuL5vTABaeSrzeMTAWagWTRQQVT/6XMNNJRbpHj+Fp8rd4sIRnqv86hYL1aoE1THuxqT451ZRYHJoCiZ3PQPMEhAzR5F6Voji6RkyJL8S662Ai/FesEeNyc2hcErfnfFCsKWckUOg8YOIR+DSfuJ6LtZZB/+SAE/QzKzIvMWuLCiGFR2oSiY7MqeJCm5CeF06YGddnQhGoqM6ZC6/hFkWAJ0Uzc5DRlxyFovaQ== gav_mac
  
  # markt
  ssh-dss AAAAB3NzaC1kc3MAAACAVaMrsS2AKvOFn4RZjBWxrwF3NxJ6jvy3ZJhbd+LH/JigL1J6o26Z5AV8HsfhOuVqj6kPaIAJ3bwaMjHrzl4nkFDS3QXDD3psrZbMtqIaugwzNOY7WDsHF0sfr6A/PoktNkoXF/BPqByx9DJ7UKq2+MP9LTj9r7Nzb5nS5L+dwDUAAAAVAI6xcksdw9IsgHW8LUeWSS+pGeXzAAAAgDhIVTB7UgFhX8Qjm/IdKVvR6hjYJ04HQnTqsnDzM2ju/Di4ATpogsUunnI7ZsBgOPF/moAzBlK+r+4621ggAW1xfRysvJYtqS0IYmyLPWryIb2xK4i6bagYhjtD2YAJbFuYmZHfyCUf82MVgqPeRRn9BWzCVzvA+7+K1rj5RlvUAAAAgBWbDECq37AFDQuMHRJiTAYJQLVBtfx3Fr/XbgkcX7DMPLXooDIAJWpqtyyfxYRHC4KRKmzDWE97Cw/03DpthAgpB+svxJghh895oAtoaCxhVzUrV0HUKQlNvg9a8s83w/iiHmoURB8kPZGyW1WJPS4ezsj/62WK1LXjmJK81pvf
  
  # jfarrell
  ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEAnQoEPismA8x2TJNhiHXzS4HbbuCAZiED8cbDaBK1M8SddW/9em3QdMnqTPv7DClYAweNqOeVRIZKsXKZdsO8+uDIZtNOhMhaB3hd1PUJRgbMvdFj20mRy5eneGSrFBKO6BRSgt1IoOrqPsbzVdXYr8wmnFEhT8JAyoePSyEoAmqXegj8ydiMndMnih2FZxpG/g8L5gYWRHiNdOCEpNrTofgZ8aYFJqNlIh3dK8bpV8O34/bPtWvx5WAvwvSHN6lt6AxyPRwKSFVHBrhF/YX2XtHyLqNviYG0VTlv8lnIHiOKIbFzgC8qjHGYhqo66V2m98+hEuyNjWC4B/Gj5JBrjQ== jfarrell@apache.org
  
  # cml
  ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEAn5MYIbWTJB6ni69vgMUJXqexctL5KTG9yAP6nfas2Akdu6GAO0fL1cCGq/TV/0LKWM/XeSkdZMo1LxqsmJZpp9BvcDYEmUhR31N+eQE1SPf8qrtFJFAN1GbmMxYwiYbAO+4zjJu+YLV0zUeSMZX56pCpbd4kaDLgY8rXzUbo934e2s5AdKHUKh65gzMwP9gzyeq02/jEfET2VSN7Xz0mqxbF47+81beQZuxySfO1M68mFLQavSt6J/E90M9ljy/oylGTTUnmZlmcxk4smuN2V8YzZsJHkGB9bh0bK5xHqci9QRmSA4nxprNL6bqpnUHtYtNQsvPrTlyEFD28qePQEQ== cml

  # coreyg
  ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDHYMoa75Fk4lADlvuvYOhk1qsRH29YGL+KBNpEjkuW+lVJynzhXsXTPvRiuqSleB9ewryLl5qn3ONrj1sb4efWKuYa9nan8LYwiJcgknZtUKOCmaf1cL9aDMSBdy/qPqZSd3IMuy1zzYmJcSrMSkZlElwq1bEGlUdL5oIp8Tj/bxMAacneBqax6n/tvgq4XhlQvt8yrPFNSwslOyAgbsDsaUoIT6MGzzm+LHlN+fOD7oMAkWM7hyRV3fXE4QsKmcLI+gQEjaQ9n8jcVWWKG81/br+69qgbK86gbf/laqWpxCyRlrvUZojwjiNSBz5lKt5xdgBPBPaBGrPet9+oJ5C8MZFr8evPx8iwSA452GC7/Te99Nf+5PHNqIM3hotG7dlM+NYJfVDVEqOTwc2pTF6FSi05qjym9Ikg9XUD3OB1YqfV/axBThU3LTuY3353YmDDvIKKU+HrCzDbkCPb1Yo9VTi6r6c4nXP1iHT4BVV39Tr+TohajfPB917KogOC4BeMFKjhZXtd+SUHYLvSnI3sFaX18Mi3jNI87Jcvcd0FcnrDM9QXqgNZzP7DBzzmFnjAal7ptiB/G8G/T/BQADVGd0g8W8s0wVOBkKZmFGG7TGCxjN8/gLIdi6cecFK46BXRZwPNz+H/lZCjdN9CWkOQjNhBQF6J6f36RWTCmnQk1Q== coreyg@apache.org

asf999::create_user::sshdkeysdir: '/etc/ssh/ssh_keys'
asf999::create_user::user: 'asf999'

## LDAPCLIENT
ldapclient::ldapcert: |
  -----BEGIN CERTIFICATE-----
  MIIE7jCCA9agAwIBAgIJAKVPvcTSmTbFMA0GCSqGSIb3DQEBBQUAMIGqMQswCQYD
  VQQGEwJVUzERMA8GA1UECBMITWFyeWxhbmQxFTATBgNVBAcTDEZvcnJlc3QgSGls
  bDEjMCEGA1UEChMaQXBhY2hlIFNvZnR3YXJlIEZvdW5kYXRpb24xFzAVBgNVBAsT
  DkluZnJhc3RydWN0dXJlMRMwEQYDVQQDEwphcGFjaGUub3JnMR4wHAYJKoZIhvcN
  AQkBFg9yb290QGFwYWNoZS5vcmcwHhcNMTQwNDAzMTcwNzMxWhcNMjQwMzMxMTcw
  NzMxWjCBqjELMAkGA1UEBhMCVVMxETAPBgNVBAgTCE1hcnlsYW5kMRUwEwYDVQQH
  EwxGb3JyZXN0IEhpbGwxIzAhBgNVBAoTGkFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0
  aW9uMRcwFQYDVQQLEw5JbmZyYXN0cnVjdHVyZTETMBEGA1UEAxMKYXBhY2hlLm9y
  ZzEeMBwGCSqGSIb3DQEJARYPcm9vdEBhcGFjaGUub3JnMIIBIjANBgkqhkiG9w0B
  AQEFAAOCAQ8AMIIBCgKCAQEAxb2CT2ZhJFYifDAloSpIV2vGoys280UsDvz77sTO
  AcdAyuNHH7uwfVQMc68IXunB2KP0XL1r0Ur9Opm0E8RjFW2P9qquDDcgX8Noghv+
  q5gxWeOePFqe9BsQov6Xr42SUT1YSQ3/2g3j1jTOCzNy7/XszLuI4BJLu6/R+VX+
  e7YczTeednj4mU/KGJbzrTj+VdQW8ZPsPdlvCFp9NO9v00rKt3A/7XuyYBJwlgvD
  3r6J8M7UkCuIuLwEQxKeINso853Ucpvd42xfuUiBV4ahEOyEblT5YPL7n1V5BxD/
  qhAV7neq9pVz0to9HF1GjafK/k5tUiTFx3XbBzHgRa7z/wIDAQABo4IBEzCCAQ8w
  HQYDVR0OBBYEFI669DBJxSoUJihXSlQK7VDUnsPKMIHfBgNVHSMEgdcwgdSAFI66
  9DBJxSoUJihXSlQK7VDUnsPKoYGwpIGtMIGqMQswCQYDVQQGEwJVUzERMA8GA1UE
  CBMITWFyeWxhbmQxFTATBgNVBAcTDEZvcnJlc3QgSGlsbDEjMCEGA1UEChMaQXBh
  Y2hlIFNvZnR3YXJlIEZvdW5kYXRpb24xFzAVBgNVBAsTDkluZnJhc3RydWN0dXJl
  MRMwEQYDVQQDEwphcGFjaGUub3JnMR4wHAYJKoZIhvcNAQkBFg9yb290QGFwYWNo
  ZS5vcmeCCQClT73E0pk2xTAMBgNVHRMEBTADAQH/MA0GCSqGSIb3DQEBBQUAA4IB
  AQAI7HP4tVEj8DZ1fiKH947RsRuC12H4mIeO6H9P15rFp9AkDgZxIGjoGW13yGhn
  p/4jDNZWwitCoj4ztDCrMjb9v5xuHhOB/Ny5N4eByEPpiZ3z/626XDHSjfc36F0Y
  ey2ghZN7EU0eG3q9GPjDDXjefEyieN8p6QjBCeTOGAF25pX/8AxNO/Znk2D4LGGm
  S1GpVMgMmwfXR4lncdwpRnpu/k2z079SROSmuFnwsMtGOeBA/1tGXBF/5LuLpKyk
  1BXsdDCBgYk+eXh4gG/GJaI/IvDyAp81cF2oFbqQY1fc8heMHhQ1667EOqRrqe/k
  P6Hk8NQdShbeE0/nDvYchhV5
  -----END CERTIFICATE-----

ldapclient::authorizedkeysfolder: '/etc/ssh/bin'
ldapclient::authorizedkeysfile: 'asf-ldap-sshkeys.sh'
ldapclient::nssbinddn: 'cn=nss_ldap,ou=users,ou=services,dc=apache,dc=org'
ldapclient::nssbindpasswd: 'b1t3me'

ntp::servers:
  - 0.freebsd.pool.ntp.org
  - 1.freebsd.pool.ntp.org
  - 2.freebsd.pool.ntp.org
ntp::restrict:
  - 127.0.0.1

## SNMP
snmp::agentaddress: 'udp:*:161'
snmp::com2sec:
  - "circonus-broker 140.211.11.6 asfro"
snmp::groups:
  - "circonus-broker v2c circonus-broker"
snmp::views:
  - "all included .1"
snmp::accesses:
  - 'circonus-broker "" any noauth exact all none all'
snmp::snmpd_config:
  - 'rouser monitor authNoPriv'
  - 'smuxpeer .1.3.6.1.4.1.674.10892.1'

## SpamAssassin
spamassassin::required_hits: '10' #Scores over this value with tagged as spam.
spamassassin::custom_scoring:
  - 'ALL_TRUSTED          -2000.0'
  - 'DRUGS_MUSCLE             4.0'
  - 'URIBL_SBL                4.0'
  - 'URIBL_WS_SURBL           4.0'
  - 'RCVD_IN_BL_SPAMCOP_NET   2.0'
  - 'RCVD_IN_XBL              4.0'
  - 'RCVD_IN_PBL              0.0'
  - 'RCVD_IN_RP_RNBL          0.0'
  - 'RDNS_NONE                0.0'
  - 'HTML_MESSAGE             2.2'
  - 'EXTRA_MPART_TYPE         3.0'
  - 'MIME_HTML_ONLY           3.5'
  - 'URIBL_BLACK              3.5'
  - 'DCC_CHECK                4.0'
  - 'HELO_DYNAMIC_SPLIT_IP    0.0'
  - 'FM_FAKE_HELO_VERIZON     0.0'
  - 'FORGED_MUA_OIMO          0.0'
  - 'TVD_SPACED_SUBJECT_WORD3 0.0'
  - 'TVD_SPACE_RATIO          0.0'
  - 'FORGED_MUA_OUTLOOK       0.0'
  - 'WHOIS_CONTACTPRIV        0.0'
  - 'FREEMAIL_FROM            0.0'
  - 'FREEMAIL_REPLYTO         0.0'
  - 'FREEMAIL_FORGED_REPLYTO  0.0'
  - 'FSL_FREEMAIL_1           0.0'
  - 'FSL_FREEMAIL_2           0.0'
  - 'FH_DATE_PAST_20XX        0.0'
  - 'FRT_ADOBE2               0.0'

spamassassin::custom_rules: |
  "# Rule from jm on 8/27/2004"
  "header MISSING_FROM       From =~ /^UNSET$/ [if-unset: UNSET]"
  "describe MISSING_FROM     Missing From: header"
  "score MISSING_FROM        5.0"
  ""
  "header ASF_SUB_ENC Subject:raw =~ /=\?(KOI|windows-1251|windows-874)/i"
  "describe ASF_SUB_ENC  Bad Subject: encoding"
  "score ASF_SUB_ENC      10"
  ""
  "# 2007-09-04 allow list ops with empty message"
  "header ASF_LIST_OPS      To =~ /(subscribe|-help|-list|-log|-edit)\@/i"
  "meta ASF_EMPTY_LIST_OPS  (ASF_LIST_OPS && (EMPTY_MESSAGE || MISSING_SUBJECT))"
  "score ASF_EMPTY_LIST_OPS -5.0"
  "score ASF_LIST_OPS       -2.0"
  ""
  "# 2009-11-16 Be extra lenient for unsubscribe"
  "header ASF_LIST_UNSUB_A To =~ /(-unsubscribe)\@/i"
  "score ASF_LIST_UNSUB_A -10"
  "header ASF_LIST_UNSUB_B To =~ /(-unsubscribe-.*?)\@/i"
  "score ASF_LIST_UNSUB_B -10"
  ""
  ""
  "# 2007-06-13 deal with server-dev@james moderation spam"
  "header ASF_LIST_SERVER_DEV_A   From =~ /\@bellsouth.net/i"
  "body ASF_LIST_SERVER_DEV_B     /\bLottery\b/i"
  "meta ASF_LIST_SERVER_DEV       (ASF_LIST_SERVER_DEV_A && ASF_LIST_SERVER_DEV_B)"
  "score ASF_LIST_SERVER_DEV      10"
  "score ASF_LIST_SERVER_DEV_A    0.1"
  "score ASF_LIST_SERVER_DEV_B    0.1"
  ""
  "# 2008-01-22 deal with hc and jmeter moderation spam"
  "header ASF_LIST_HC_JMETER_A   From =~ /kohls\@e.kohls.com/"
  "header ASF_LIST_HC_JMETER_B   From =~ /xuhl\@cnbearing.com/"
  "score ASF_LIST_HC_JMETER_A     10"
  "score ASF_LIST_HC_JMETER_B     10"
  ""
  "header ASF_ADMIN        To =~ /(postmaster|abuse)\@/i"
  "score  ASF_ADMIN        -100"
  ""
  "header ASF_MELTWATER  From =~ /meltwaternews.com/"
  "score  ASF_MELTWATER  -100"
  ""
  "meta __PILL_PRICE_1  (0)"
  "meta __PILL_PRICE_2  (0)"
  "meta __PILL_PRICE_3  (0)"


## SSH
ssh::client_options:
    'Host *':
        SendEnv: 'LANG LC_*'
        ForwardX11Trusted: 'no'
        ServerAliveInterval: '10'

ssh::params::sshd_keysdir: '/etc/ssh/ssh_keys'

ssh::server_options:
    Protocol: '2'
    ListenAddress: '0.0.0.0'
    PasswordAuthentication: 'no'
    SyslogFacility: 'AUTHPRIV'
    UsePAM: 'yes'
    X11Forwarding: 'no'
    AuthorizedKeysCommand: '/etc/ssh/bin/asf-ldap-sshkeys.sh'
    AuthorizedKeysCommandUser: 'root'
    AuthorizedKeysFile: '/etc/ssh/ssh_keys/%u.pub'

