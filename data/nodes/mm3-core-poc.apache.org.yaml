---
classes:
  - apache
  - apache::mod::wsgi
  - mailman3::core
  - mailman3::postorius
  - postgresql::client
  - postgresql::lib::devel
  - python
  - vhosts_asf::vhosts

apache::default_vhost: false
apache::mod::wsgi::wsgi_python_home: '/var/www/postorius/venv2'

mailman3::core::config::databaseurl: 'postgres://mm3:mm3password@10.40.0.12/mm3'
mailman3::core::config::vardir: '/usr/local/mailman3-core/mailman'
mailman3::core::config::pidfile: '/var/run/mailman/master.pid'
mailman3::core::config::db: 'postgresql'
mailman3::core::config::webservicehostname: "${%{::ipaddress_eth1}"
mailman3::postorius::config::db: 'postgresql'
mailman3::postorius::config::dbhost: '192.168.33.3'
mailman3::postorius::config::dbname: 'postorius'
mailman3::postorius::config::dbuser: 'postorius'
mailman3::postorius::config::mailman_api_url: "http://${::ipaddress_eth1}:8001"
mailman3::postorius::config::allowed_hosts:
  - '*'


python::version: 'system'
python::pip: true
python::dev: true
python::virtualenv: true
python::gunicorn: false
python::manage_gunicorn: true

vhosts_asf::vhosts::vhosts:
  postorius:
    vhost_name: '*'
    port: 80
    servername: 'postorius.apache.org'
    default_vhost: true
    docroot: '/var/www/postorius/postorius_standalone'
    manage_docroot: false
    access_log_file: 'postorius_access.log'
    error_log_file: 'postorius_error.log'
    custom_fragment: |
      Alias /static /var/www/postorius/postorius_standalone/static

      <Directory "/var/www/postorius/postorius_standalone/static">
        Order deny,allow
        Allow from all
      </Directory>

      WSGIScriptAlias / /var/www/postorius/postorius_standalone/srv/postorius.wsgi
      <Directory "/var/www/postorius/postorius_standalone/srv">
        Order deny,allow
        Allow from all
      </Directory>

