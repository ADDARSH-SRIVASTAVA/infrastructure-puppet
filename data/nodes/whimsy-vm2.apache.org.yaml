---
classes:
- apache
- whimsy_server
- vhosts_asf::vhosts

apache::keepalive: 'On'
apache::keepalive_timeout: '15'
apache::timeout: 600
apache::mpm_module: 'event'
apache::mod::event::listenbacklog: '511'
apache::mod::event::maxclients: '500'
apache::mod::event::maxconnectionsperchild: '200000'
apache::mod::event::maxrequestworkers: '500'
apache::mod::event::maxsparethreads: '250'
apache::mod::event::minsparethreads: '150'
apache::mod::event::serverlimit: '10'
apache::mod::event::startservers: '5'
apache::mod::event::threadlimit: '500'
apache::mod::event::threadsperchild: '50'
apache::default_vhost: false

logrotate::rule:
  apache2:
    ensure: 'present'

vhosts_asf::vhosts::vhosts:
  whimsy-vm-80:
    vhost_name: '*'
    default_vhost: true
    ip: "%{::ipaddress_eth1}"
    servername: 'whimsy-vm2.apache.org'
    port: 80
    docroot: '/srv/whimsy/www'
    error_log_file: 'whimsy_error.log'
    access_log_file: 'whimsy_access.log'
